<p-card>
  <div class="p-grid p-justify-center">
    <div class="p-col-1">
      <p-radioButton label="Pending" name="pending" value="pending" [(ngModel)]="status"></p-radioButton>
    </div>
      <div class="p-col-1">
      <p-radioButton label="Reviewing" name="reviewing" value="reviewing" [(ngModel)]="status"></p-radioButton>
      </div>
        <div class="p-col-1">
      <p-radioButton label="Reviewed" name="reviewed" value="reviewed" [(ngModel)]="status"></p-radioButton>
        </div>
          <div class="p-col-1">
      <p-radioButton label="Rejected" name="rejected" value="rejected" [(ngModel)]="status"></p-radioButton>
    </div>
    <input disabled placeholder="Find By Email" [(ngModel)]="reportedByFilter" size="30" pInputText>
    <p-inputNumber [disabled]="true" [(ngModel)]="itemsToReturnFilter" placeholder="N items to return"></p-inputNumber>
    <button class="p-col-1 margin-15" pButton type="button" label="Apply Filter" (click)="loadReports()"></button>
  </div>
</p-card>

<p-table
  #dt
  [columns]="reportColumns"
  [value]="reports"
  [autoLayout]="true"
  [rowHover]="true"
>
  <ng-template pTemplate="header" let-columns>
    <tr>
      <th [pSortableColumn]="col.field" *ngFor="let col of columns">
        {{ col.header }}
        <p-sortIcon [field]="col.field"></p-sortIcon>
      </th>
      <th class="action-column">Action</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-rowData let-columns="columns">
    <tr>
      <td *ngFor="let col of columns; let i = index">
        <a target="_blank"
           *ngIf="col.field === 'ReportedByID'"
           [routerLink]="['/admin/audit', rowData.ReportedByID]"
        ><i class="pi pi-info-circle"></i
        ></a>
        <a target="_blank"
           *ngIf="col.field === 'ReviewedById'"
           [routerLink]="['/admin/audit', rowData.ReviewedById]"
        ><i class="pi pi-info-circle"></i
        ></a>
        <a
          *ngIf="col.field === 'URI'"
          href="https://odysee.com/{{ rowData.URI }}"
          target="_blank"
        >{{ rowData[col.field]}}</a>
        <p-triStateCheckbox *ngIf="col.field === 'IsActionTaken'"
          class="p-col-4" [(ngModel)]="rowData.IsActionTaken" disabled="true">
        </p-triStateCheckbox>
        <span
          *ngIf="
                col.field !== '' &&
                col.field !== 'ShouldSync' &&
                col.field !== 'UserRewardEnabled' &&
                col.field !== 'Reviewed'
              "
        >{{ rowData[col.field] }}</span>
      </td>
      <td>
        <p-button label="Review"(onClick)="reviewReport(rowData)"></p-button>
      </td>
    </tr>
  </ng-template>
</p-table>

<p-dialog [header]="'Report#'+review.ReportID" [(visible)]="isReviewing" modal="true" *ngIf="review">
  <div>
    <a
      href="https://odysee.com/$/search?q={{ review.ClaimID }}"
      target="_blank"
    >{{review.ClaimID}}</a>
    <h3>User Info</h3>
    <div *ngFor="let item of User | keyvalue">
      <b>{{item.key}}</b>: {{item.value}}
    </div>
    <h3>Details</h3>
    <div *ngFor="let item of Details | keyvalue">
      <b>{{item.key}}</b>: {{item.value}}
    </div>
    <h3>Leave a comment here:</h3>
    <div>
      <input type="text" [(ngModel)]="review.ReviewerComment" placeholder="Leave a comment">
    </div>
  </div>
  <p-footer>
    <div class="ui-dialog-buttonpane ui-helper-clearfix">
      <button type="button" pButton icon="fa fa-check" (click)="confirmReview('reviewed')" label="Approve"></button>
      <button type="button" pButton icon="fa fa-check" (click)="confirmReview('reviewing')" label="Need more information"></button>
      <button type="button" pButton icon="fa fa-close" (click)="confirmReview('rejected')" label="Reject"></button>
    </div>
  </p-footer>
</p-dialog>
